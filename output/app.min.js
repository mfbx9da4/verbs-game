/*! blog 2014-02-17 */
function createTable(){var a="";return a+="<table>",a+="<tbody>",a+="</tbody>",a+="</table>"}var AentropicoApp=angular.module("AentropicoApp",["angularFileUpload","ngRoute"]);AentropicoApp.config(function(a){a.when("/about",{templateUrl:"../README.html",controller:"aboutController"}).when("/game",{templateUrl:"../html/game.html",controller:"gameController"}).when("/login",{templateUrl:"../html/login.html",controller:"loginController"}).when("/profile/:username",{templateUrl:"../html/profile.html",controller:"profileController"}).otherwise({redirectTo:"/game"})}),AentropicoApp.controller("homeController",["$scope","$http","$location",function(a,b){a.user_found=!0,b.get("/get_user").success(function(b){b?a.username=b.user:a.user_found=!1}).error(function(a){throw new Error(a)})}]),AentropicoApp.controller("profileController",["$scope","$http","$location",function(a,b){a.get_user=function(a){b.get("/get_user").success(function(b){b?a(b):alert("Please login")}).error(function(a){throw consle.log("error getting user"),new Error(a)})},a.loadVerbs=function(a){console.log(a),b.get("/api/get_verbs").success(function(b){console.log(b);var c=$("#verbs-table");for(var d in b){var e=b[d],f="<tr>";f+="<td>"+d+"</td>",f+="<td><table class='table'><tbody>";for(var g in e){var h=e[g];f+="<tr><td>"+g+"</td>",f+="<td><table class='table'><tbody>";for(var i in h){var j=h[i];f+="<tr>",f+="<td>"+j.en+"</td>",f+="<td><table class='table'><tbody>";var k=a.responses[j.id];k&&(f+="<tr><td><div style='height:1em; background-color: steelblue; width:"+k.right/3*100+"px'></div></tr>",f+="<tr><td><div style='height:1em; background-color: coral; width:"+k.wrong/3*100+"px'></div></tr>"),f+="</table></tbody></td>",f+="</tr>"}f+="</table></tbody></td>",f+="</tr>"}f+="</table></tbody></td>",f+="</tr>",console.log(f),c.append($(f))}}).error(function(){console.log("error getting verbs")})},a.get_user(a.loadVerbs)}]),AentropicoApp.controller("gameController",["$scope","$http","$location",function(a,b,c){a.questions=[],a.percent_complete=0,a.answer_submitted=!1,a.progress_mode=!1,a.button_text="Submit",$("#response").focus(),$("#response").on("keyup",function(b){13===b.keyCode&&a.submit()});var d=function(a){return a=a.replace(/\s/,""),a=a.replace(/é/,"e"),a=a.replace(/ó/,"o"),a=a.replace(/õ/,"o"),a=a.replace(/ẽ/,"e"),a=a.replace(/ñ/,"n"),a=a.replace(/ã/,"a"),console.log(a),a},e=function(a,b){a=d(a);for(var c=0;c<b.length;c++){var e=b[c];if(e=d(e),a===e)return!0}};a.start_level=function(){b.get("/api/get_level/0").success(function(b){a.questions=b,a.question_number=0;var c=a.questions[a.question_number];a.question=c.en[0],a.answers=c.pt}).error(function(a){throw new Error(a)})},a.showAnswer=function(b){a.$apply(function(){a.answer_submitted=!0,a.answer_status_text=b?"You were right!":"You were wrong.",a.answer_status_text+=" Accepted answers:",a.button_text="Continue"})},a.updateScore=function(b){b?a.questions[a.question_number].right=1:a.questions[a.question_number].wrong=1},a.submit=function(){a.progress_mode?a.progress():a.submit_answer()},a.submit_answer=function(){if(a.response){var b=e(a.response,a.answers);a.updateScore(b),a.showAnswer(b),a.progress_mode=!0}},a.progress=function(){var d=(a.question_number+1)/a.questions.length*100;a.$apply(function(){a.percent_complete=d}),a.question_number==a.questions.length-1?b.get("/get_user").success(function(d){if(d){var e=d.user;b.post("/update_user/"+e,{responses:a.questions}).success(function(){c.path("/profile/"+e)}).error(function(a){throw new Error(a)})}else alert("Please login")}).error(function(a){throw new Error(a)}):a.$apply(function(){a.progress_mode=!1,a.answer_submitted=!1,a.response="",a.question_number++;var b=a.questions[a.question_number];a.question=b.en[0],a.answers=b.pt})},a.start_level()}]),AentropicoApp.controller("aboutController",["$scope",function(){}]),AentropicoApp.controller("loginController",["$scope",function(){}]);